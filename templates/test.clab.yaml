# CCNA Fundamentals: One Switch + Two Hosts (Corrected)
# - sw1: Linux bridge with two ports (eth1, eth2) added to br0
# - pc1 and pc2 connected via separate links
# - IPs assigned automatically

name: two-hosts-switch

topology:
  nodes:
    sw1:
      kind: linux
      image: ghcr.io/hellt/network-multitool
      cmd: |
        bash -c "
        # Create bridge
        ip link add br0 type bridge && \
        ip link set br0 up && \
        # Add ContainerLab-created ports to the bridge
        ip link set eth1 master br0 && \
        ip link set eth2 master br0 && \
        ip link set eth1 up && \
        ip link set eth2 up && \
        sleep infinity
        "

    pc1:
      kind: linux
      image: ghcr.io/hellt/network-multitool
      cmd: |
        bash -c "
        ip addr add 192.168.10.10/24 dev eth1 && \
        ip link set eth1 up && \
        sleep infinity
        "



  links:
    # Each link uses a UNIQUE interface on sw1
    - endpoints: ["pc1:eth1", "sw1:eth1"]
